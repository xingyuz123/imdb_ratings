2025-06-19 15:53:50 - INFO - movie_database - download_title_df - Fetching basic title data
2025-06-19 15:53:58 - INFO - movie_database - download_title_df - Fetching ratings data
2025-06-19 16:46:21 - INFO - movie_database - download_title_df - Starting IMDB data download and processing
2025-06-19 16:46:21 - INFO - movie_database - _download_basics_data - Fetching basic title data from IMDB
2025-06-19 16:46:29 - INFO - movie_database - _process_basics_data - Processing basic title data
2025-06-19 16:46:29 - INFO - movie_database - _download_ratings_data - Fetching ratings data from IMDB
2025-06-19 16:46:30 - INFO - movie_database - _process_ratings_data - Processing ratings data (min votes: 15,000)
2025-06-19 16:46:30 - INFO - movie_database - _join_title_and_ratings - Joining title and ratings data
2025-06-19 16:46:30 - INFO - movie_database - download_title_df - Successfully processed 11,107 titles
2025-06-20 12:00:10 - INFO - movie_database - download_title_df - Starting IMDB data download and processing
2025-06-20 12:00:10 - INFO - movie_database - _download_basics_data - Fetching basic title data from IMDB
2025-06-20 12:00:35 - INFO - movie_database - _process_basics_data - Processing basic title data
2025-06-20 12:00:35 - INFO - movie_database - _download_ratings_data - Fetching ratings data from IMDB
2025-06-20 12:00:36 - INFO - movie_database - _process_ratings_data - Processing ratings data (min votes: 15,000)
2025-06-20 12:00:36 - INFO - movie_database - _join_title_and_ratings - Joining title and ratings data
2025-06-20 12:00:36 - INFO - movie_database - download_title_df - Successfully processed 11,107 titles
2025-06-20 19:22:13 - INFO - movie_database - download_title_df - Starting IMDB data download and processing
2025-06-20 19:22:13 - INFO - movie_database - _download_basics_data - Fetching basic title data from IMDB
2025-06-20 19:22:34 - INFO - movie_database - _process_basics_data - Processing basic title data
2025-06-20 19:22:34 - INFO - movie_database - _download_ratings_data - Fetching ratings data from IMDB
2025-06-20 19:22:35 - INFO - movie_database - _process_ratings_data - Processing ratings data (min votes: 15,000)
2025-06-20 19:22:35 - INFO - movie_database - _join_title_and_ratings - Joining title and ratings data
2025-06-20 19:22:35 - INFO - movie_database - download_title_df - Successfully processed 11,107 titles
2025-06-20 19:33:08 - INFO - movie_database - download_title_df - Starting IMDB data download and processing
2025-06-20 19:33:08 - INFO - movie_database - _download_basics_data - Fetching basic title data from IMDB
2025-06-20 19:34:12 - INFO - movie_database - download_title_df - Starting IMDB data download and processing
2025-06-20 19:34:12 - INFO - movie_database - _download_basics_data - Fetching basic title data from IMDB
2025-06-20 19:34:32 - INFO - movie_database - _process_basics_data - Processing basic title data
2025-06-20 19:34:33 - INFO - movie_database - _download_ratings_data - Fetching ratings data from IMDB
2025-06-20 19:34:34 - INFO - movie_database - _process_ratings_data - Processing ratings data (min votes: 15,000)
2025-06-20 19:34:34 - INFO - movie_database - _join_title_and_ratings - Joining title and ratings data
2025-06-20 19:34:34 - INFO - movie_database - download_title_df - Successfully processed 11,107 titles
2025-06-20 19:34:35 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 1: {}
2025-06-20 19:34:35 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 2: {}
2025-06-20 19:34:36 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 3: {}
2025-06-20 19:34:37 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 4: {}
2025-06-20 19:34:38 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 5: {}
2025-06-20 19:34:38 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 6: {}
2025-06-20 21:37:46 - INFO - movie_database - download_title_df - Starting IMDB data download and processing
2025-06-20 21:37:46 - INFO - movie_database - _download_basics_data - Fetching basic title data from IMDB
2025-06-20 21:38:07 - INFO - movie_database - _process_basics_data - Processing basic title data
2025-06-20 21:38:07 - INFO - movie_database - _download_ratings_data - Fetching ratings data from IMDB
2025-06-20 21:38:08 - INFO - movie_database - _process_ratings_data - Processing ratings data (min votes: 15,000)
2025-06-20 21:38:08 - INFO - movie_database - _join_title_and_ratings - Joining title and ratings data
2025-06-20 21:38:08 - INFO - movie_database - download_title_df - Successfully processed 11,107 titles
2025-06-20 21:56:18 - INFO - movie_database - download_title_df - Starting IMDB data download and processing
2025-06-20 21:56:18 - INFO - movie_database - _download_basics_data - Fetching basic title data from IMDB
2025-06-20 21:56:38 - INFO - movie_database - _process_basics_data - Processing basic title data
2025-06-20 21:56:38 - INFO - movie_database - _download_ratings_data - Fetching ratings data from IMDB
2025-06-20 21:56:39 - INFO - movie_database - _process_ratings_data - Processing ratings data (min votes: 15,000)
2025-06-20 21:56:39 - INFO - movie_database - _join_title_and_ratings - Joining title and ratings data
2025-06-20 21:56:39 - INFO - movie_database - download_title_df - Successfully processed 11,107 titles
2025-06-20 21:59:47 - INFO - movie_database - download_title_df - Starting IMDB data download and processing
2025-06-20 21:59:47 - INFO - movie_database - _download_basics_data - Fetching basic title data from IMDB
2025-06-20 22:01:10 - INFO - movie_database - download_title_df - Starting IMDB data download and processing
2025-06-20 22:01:10 - INFO - movie_database - _download_basics_data - Fetching basic title data from IMDB
2025-06-20 22:01:29 - INFO - movie_database - _process_basics_data - Processing basic title data
2025-06-20 22:01:29 - INFO - movie_database - _download_ratings_data - Fetching ratings data from IMDB
2025-06-20 22:01:30 - INFO - movie_database - _process_ratings_data - Processing ratings data (min votes: 15,000)
2025-06-20 22:01:30 - INFO - movie_database - _join_title_and_ratings - Joining title and ratings data
2025-06-20 22:01:30 - INFO - movie_database - download_title_df - Successfully processed 11,107 titles
2025-06-20 22:01:31 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 1: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:01:32 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 2: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:01:33 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 3: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:01:33 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 4: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:01:34 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 5: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:01:35 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 6: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:01:35 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 7: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:01:36 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 8: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:01:36 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 9: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:01:37 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 10: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:01:37 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 11: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:01:38 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 12: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:01:38 - INFO - update_supabase - update_title_table - Data update completed successfully
2025-06-20 22:26:04 - INFO - movie_database - download_title_df - Starting IMDB data download and processing
2025-06-20 22:26:04 - INFO - movie_database - _download_basics_data - Fetching basic title data from IMDB
2025-06-20 22:26:29 - INFO - movie_database - _process_basics_data - Processing basic title data
2025-06-20 22:26:30 - INFO - movie_database - _download_ratings_data - Fetching ratings data from IMDB
2025-06-20 22:26:31 - INFO - movie_database - _process_ratings_data - Processing ratings data (min votes: 15,000)
2025-06-20 22:26:31 - INFO - movie_database - _join_title_and_ratings - Joining title and ratings data
2025-06-20 22:26:31 - INFO - movie_database - download_title_df - Successfully processed 11,107 titles
2025-06-20 22:26:32 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 1: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:26:33 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 2: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:26:33 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 3: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:26:34 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 4: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:26:35 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 5: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:26:35 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 6: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:26:35 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 7: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:26:36 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 8: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:26:36 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 9: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:26:37 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 10: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:26:37 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 11: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:26:37 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 12: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:26:37 - INFO - update_supabase - update_title_table - Data update completed successfully
2025-06-20 22:29:29 - INFO - movie_database - download_title_df - Starting IMDB data download and processing
2025-06-20 22:29:29 - INFO - movie_database - _download_basics_data - Fetching basic title data from IMDB
2025-06-20 22:29:53 - INFO - movie_database - _process_basics_data - Processing basic title data
2025-06-20 22:29:53 - INFO - movie_database - _download_ratings_data - Fetching ratings data from IMDB
2025-06-20 22:29:55 - INFO - movie_database - _process_ratings_data - Processing ratings data (min votes: 15,000)
2025-06-20 22:29:55 - INFO - movie_database - _join_title_and_ratings - Joining title and ratings data
2025-06-20 22:29:55 - INFO - movie_database - download_title_df - Successfully processed 11,107 titles
2025-06-20 22:29:55 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 1: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:29:56 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 2: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:29:57 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 3: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:29:57 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 4: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:29:58 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 5: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:29:59 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 6: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:29:59 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 7: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:29:59 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 8: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:30:00 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 9: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:30:00 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 10: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:30:01 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 11: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:30:01 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 12: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:30:01 - INFO - update_supabase - update_title_table - Data update completed successfully
2025-06-20 22:30:21 - INFO - movie_database - download_title_df - Starting IMDB data download and processing
2025-06-20 22:30:21 - INFO - movie_database - _download_basics_data - Fetching basic title data from IMDB
2025-06-20 22:30:43 - INFO - movie_database - _process_basics_data - Processing basic title data
2025-06-20 22:30:43 - INFO - movie_database - _download_ratings_data - Fetching ratings data from IMDB
2025-06-20 22:30:44 - INFO - movie_database - _process_ratings_data - Processing ratings data (min votes: 15,000)
2025-06-20 22:30:44 - INFO - movie_database - _join_title_and_ratings - Joining title and ratings data
2025-06-20 22:30:44 - INFO - movie_database - download_title_df - Successfully processed 11,107 titles
2025-06-20 22:30:44 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 1: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:30:44 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 2: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:30:45 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 3: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:30:45 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 4: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:30:45 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 5: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:30:46 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 6: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:30:46 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 7: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:30:46 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 8: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:30:47 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 9: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:30:47 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 10: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:30:47 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 11: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:30:47 - ERROR - update_supabase - upsert_rows_into_table - titles: Error inserting batch 12: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "titles"'}
2025-06-20 22:30:47 - INFO - update_supabase - update_title_table - Data update completed successfully
2025-06-20 22:31:46 - INFO - movie_database - download_title_df - Starting IMDB data download and processing
2025-06-20 22:31:46 - INFO - movie_database - _download_basics_data - Fetching basic title data from IMDB
2025-06-20 22:32:06 - INFO - movie_database - _process_basics_data - Processing basic title data
2025-06-20 22:32:06 - INFO - movie_database - _download_ratings_data - Fetching ratings data from IMDB
2025-06-20 22:32:07 - INFO - movie_database - _process_ratings_data - Processing ratings data (min votes: 15,000)
2025-06-20 22:32:07 - INFO - movie_database - _join_title_and_ratings - Joining title and ratings data
2025-06-20 22:32:07 - INFO - movie_database - download_title_df - Successfully processed 11,107 titles
2025-06-20 22:32:25 - INFO - update_supabase - update_title_table - Data update completed successfully
2025-06-20 23:48:32 - INFO - update_supabase - update_reviews_table - Extracting reviews for 1/11107 titles: tt0004972
2025-06-20 23:48:52 - ERROR - update_supabase - upsert_rows_into_table - reviews: Error inserting batch 1: {'code': '23505', 'details': 'Key (title_id)=(4972) already exists.', 'hint': None, 'message': 'duplicate key value violates unique constraint "reviews_title_id_key"'}
2025-06-20 23:48:52 - INFO - update_supabase - update_reviews_table - Extracting reviews for 2/11107 titles: tt0006864
2025-06-20 23:49:00 - ERROR - update_supabase - upsert_rows_into_table - reviews: Error inserting batch 1: {'code': '23505', 'details': 'Key (title_id)=(6864) already exists.', 'hint': None, 'message': 'duplicate key value violates unique constraint "reviews_title_id_key"'}
2025-06-20 23:49:00 - INFO - update_supabase - update_reviews_table - Extracting reviews for 3/11107 titles: tt0010323
2025-06-20 23:51:20 - INFO - update_supabase - update_reviews_table - Extracting reviews for 1/11107 titles: tt0004972
2025-06-20 23:51:33 - INFO - update_supabase - update_reviews_table - Extracting reviews for 2/11107 titles: tt0006864
2025-06-20 23:58:14 - INFO - update_supabase - update_reviews_table - Extracting reviews for 1/11107 titles: tt0004972
2025-06-20 23:58:27 - INFO - update_supabase - update_reviews_table - Extracting reviews for 2/11107 titles: tt0006864
2025-06-20 23:59:55 - INFO - update_supabase - update_reviews_table - Extracting reviews for 1/11107 titles: tt0004972
2025-06-21 00:00:10 - INFO - update_supabase - update_reviews_table - Extracting reviews for 2/11107 titles: tt0006864
2025-06-21 12:58:48 - INFO - main_update - main - Starting IMDB ratings update process
2025-06-21 12:58:48 - INFO - main_update - main - Step 1: Updating titles table
2025-06-21 12:58:48 - INFO - update_supabase - update_title_table - Starting title table update
2025-06-21 12:58:48 - INFO - movie_database - download_title_df - Starting IMDB data download and processing
2025-06-21 12:58:48 - INFO - movie_database - _download_basics_data - Fetching basic title data from IMDB
2025-06-21 12:59:00 - INFO - movie_database - _process_basics_data - Processing basic title data
2025-06-21 12:59:00 - INFO - movie_database - _download_ratings_data - Fetching ratings data from https://datasets.imdbws.com/title.ratings.tsv.gz
2025-06-21 12:59:02 - INFO - movie_database - _process_ratings_data - Processing ratings data (min votes: 15,000)
2025-06-21 12:59:02 - INFO - movie_database - _join_title_and_ratings - Joining title and ratings data
2025-06-21 12:59:02 - INFO - movie_database - download_title_df - Successfully processed 11,108 titles
2025-06-21 12:59:04 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 1/12
2025-06-21 12:59:07 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 2/12
2025-06-21 12:59:09 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 3/12
2025-06-21 12:59:11 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 4/12
2025-06-21 12:59:12 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 5/12
2025-06-21 12:59:15 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 6/12
2025-06-21 12:59:18 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 7/12
2025-06-21 12:59:20 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 8/12
2025-06-21 12:59:22 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 9/12
2025-06-21 12:59:23 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 10/12
2025-06-21 12:59:25 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 11/12
2025-06-21 12:59:27 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 12/12
2025-06-21 12:59:28 - INFO - update_supabase - update_title_table - Title table update completed successfully
2025-06-21 12:59:28 - INFO - main_update - main - Step 2: Skipping reviews update
2025-06-21 12:59:28 - INFO - main_update - main - Step 3: Skipping Excel export
2025-06-21 12:59:28 - INFO - main_update - main - Update process completed successfully
2025-06-21 13:00:11 - INFO - main_update - main - Starting IMDB ratings update process
2025-06-21 13:00:11 - INFO - main_update - main - Step 1: Skipping titles update
2025-06-21 13:00:11 - INFO - main_update - main - Step 2: Updating reviews table
2025-06-21 13:00:11 - INFO - update_supabase - update_reviews_table - Starting reviews table update
2025-06-21 13:00:11 - INFO - update_supabase - extract_title_ids - Extracting title IDs from titles
2025-06-21 13:00:14 - INFO - update_supabase - extract_title_ids - Extracting title IDs from reviews
2025-06-21 13:00:15 - INFO - update_supabase - update_reviews_table - Found 11108 titles to process
2025-06-21 13:00:15 - INFO - update_supabase - update_reviews_table - Processing reviews for 1/11108 titles: tt0004972
2025-06-21 13:00:15 - DEBUG - scrape_reviews - get_reviews_from_title_code - Starting review extraction for tt0004972
2025-06-21 13:00:16 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 49 reviews so far for tt0004972
2025-06-21 13:00:20 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 98 reviews so far for tt0004972
2025-06-21 13:00:23 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 148 reviews so far for tt0004972
2025-06-21 13:00:26 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 195 reviews so far for tt0004972
2025-06-21 13:00:27 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 245 reviews so far for tt0004972
2025-06-21 13:00:30 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 295 reviews so far for tt0004972
2025-06-21 13:00:32 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 342 reviews so far for tt0004972
2025-06-21 13:00:35 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 380 reviews so far for tt0004972
2025-06-21 13:00:37 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 421 reviews so far for tt0004972
2025-06-21 13:00:39 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 424 reviews so far for tt0004972
2025-06-21 13:00:40 - INFO - scrape_reviews - get_reviews_from_title_code - Extracted 192/424 reviews for tt0004972 after filtering
2025-06-21 13:00:40 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 1/1
2025-06-21 13:00:41 - INFO - update_supabase - update_reviews_table - Inserted 192 reviews for tt0004972
2025-06-21 13:00:41 - INFO - update_supabase - update_reviews_table - Processing reviews for 2/11108 titles: tt0006864
2025-06-21 13:00:41 - DEBUG - scrape_reviews - get_reviews_from_title_code - Starting review extraction for tt0006864
2025-06-21 13:00:42 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 50 reviews so far for tt0006864
2025-06-21 13:00:44 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 100 reviews so far for tt0006864
2025-06-21 13:00:46 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 142 reviews so far for tt0006864
2025-06-21 13:00:48 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 144 reviews so far for tt0006864
2025-06-21 13:00:49 - INFO - scrape_reviews - get_reviews_from_title_code - Extracted 70/144 reviews for tt0006864 after filtering
2025-06-21 14:20:04 - INFO - movie_database - download_title_df - Starting IMDB data download and processing
2025-06-21 14:20:04 - INFO - movie_database - _download_basics_data - Fetching basic title data from IMDB
2025-06-21 14:20:45 - INFO - movie_database - _process_basics_data - Processing basic title data
2025-06-21 14:20:45 - INFO - movie_database - _download_ratings_data - Fetching ratings data from https://datasets.imdbws.com/title.ratings.tsv.gz
2025-06-21 14:20:46 - INFO - movie_database - _process_ratings_data - Processing ratings data (min votes: 15,000)
2025-06-21 14:20:46 - INFO - movie_database - _join_title_and_ratings - Joining title and ratings data
2025-06-21 14:20:47 - INFO - movie_database - download_title_df - Successfully processed 11,108 titles
2025-06-21 14:28:42 - INFO - movie_database - download_title_df - Starting IMDB data download and processing
2025-06-21 14:28:42 - INFO - movie_database - _download_basics_data - Fetching basic title data from https://datasets.imdbws.com/title.basics.tsv.gz
2025-06-21 14:29:47 - INFO - movie_database - _process_basics_data - Processing basic title data
2025-06-21 14:29:47 - INFO - movie_database - _download_ratings_data - Fetching ratings data from https://datasets.imdbws.com/title.ratings.tsv.gz
2025-06-21 14:29:49 - INFO - movie_database - _process_ratings_data - Processing ratings data (min votes: 15,000)
2025-06-21 14:29:49 - INFO - movie_database - _join_title_and_ratings - Joining title and ratings data
2025-06-21 14:29:49 - INFO - movie_database - download_title_df - Successfully processed 11,108 titles
2025-06-21 14:29:56 - INFO - update_supabase - download_titles_from_database - Downloading entire titles database from Supabase
2025-06-21 14:30:43 - INFO - update_supabase - download_titles_from_database - Downloading entire titles database from Supabase
2025-06-21 14:35:23 - INFO - movie_database - download_title_df - Starting IMDB data download and processing
2025-06-21 14:35:23 - INFO - movie_database - _download_basics_data - Fetching basic title data from https://datasets.imdbws.com/title.basics.tsv.gz
2025-06-21 14:36:05 - INFO - movie_database - _process_basics_data - Processing basic title data
2025-06-21 14:36:06 - INFO - movie_database - _download_ratings_data - Fetching ratings data from https://datasets.imdbws.com/title.ratings.tsv.gz
2025-06-21 14:36:08 - INFO - movie_database - _process_ratings_data - Processing ratings data (min votes: 15,000)
2025-06-21 14:36:08 - INFO - movie_database - _join_title_and_ratings - Joining title and ratings data
2025-06-21 14:36:08 - INFO - movie_database - download_title_df - Successfully processed 11,108 titles
2025-06-21 14:39:11 - INFO - update_supabase - download_titles_from_database - Downloading entire titles database from Supabase
2025-06-21 14:43:21 - INFO - movie_database - download_title_df - Starting IMDB data download and processing
2025-06-21 14:43:21 - INFO - movie_database - _download_basics_data - Fetching basic title data from https://datasets.imdbws.com/title.basics.tsv.gz
2025-06-21 14:44:28 - INFO - movie_database - _process_basics_data - Processing basic title data
2025-06-21 14:44:28 - INFO - movie_database - _download_ratings_data - Fetching ratings data from https://datasets.imdbws.com/title.ratings.tsv.gz
2025-06-21 14:44:31 - INFO - movie_database - _process_ratings_data - Processing ratings data (min votes: 15,000)
2025-06-21 14:44:31 - INFO - movie_database - _join_title_and_ratings - Joining title and ratings data
2025-06-21 14:44:31 - INFO - movie_database - download_title_df - Successfully processed 11,108 titles
2025-06-21 14:50:33 - INFO - update_supabase - download_titles_from_database - Downloading entire titles database from Supabase
2025-06-21 15:01:07 - INFO - update_supabase - download_titles_from_database - Downloading entire titles database from Supabase
2025-06-21 15:09:33 - INFO - main_update - main - Starting IMDB ratings update process
2025-06-21 15:09:33 - INFO - main_update - main - Step 1: Updating titles table
2025-06-21 15:09:33 - INFO - update_supabase - update_title_table - Starting title table update
2025-06-21 15:09:33 - INFO - movie_database - download_title_df - Starting IMDB data download and processing
2025-06-21 15:09:33 - INFO - movie_database - _download_basics_data - Fetching basic title data from https://datasets.imdbws.com/title.basics.tsv.gz
2025-06-21 15:10:19 - INFO - movie_database - _process_basics_data - Processing basic title data
2025-06-21 15:10:19 - INFO - movie_database - _download_ratings_data - Fetching ratings data from https://datasets.imdbws.com/title.ratings.tsv.gz
2025-06-21 15:10:21 - INFO - movie_database - _process_ratings_data - Processing ratings data (min votes: 15,000)
2025-06-21 15:10:21 - INFO - movie_database - _join_title_and_ratings - Joining title and ratings data
2025-06-21 15:10:21 - INFO - movie_database - download_title_df - Successfully processed 11,108 titles
2025-06-21 15:10:21 - INFO - update_supabase - download_titles_from_database - Downloading entire titles database from Supabase
2025-06-21 15:10:22 - ERROR - main_update - main - Update process failed: id

Resolved plan until failure:

	---> FAILED HERE RESOLVING 'select' <---
DF []; PROJECT */0 COLUMNS; SELECTION: None
Traceback (most recent call last):
  File "/Users/xingyuzhang/Desktop/imdb_ratings/imdb_ratings/updater/main_update.py", line 31, in main
    update_title_table()
  File "/Users/xingyuzhang/Desktop/imdb_ratings/imdb_ratings/updater/update_supabase.py", line 99, in update_title_table
    title_df_from_supabase.select(["id", "num_votes"]).rename({"num_votes": "num_votes_supabase"}),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xingyuzhang/Library/Caches/pypoetry/virtualenvs/imdb-ratings-1gaDbQ5W-py3.12/lib/python3.12/site-packages/polars/dataframe/frame.py", line 9322, in select
    return self.lazy().select(*exprs, **named_exprs).collect(_eager=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xingyuzhang/Library/Caches/pypoetry/virtualenvs/imdb-ratings-1gaDbQ5W-py3.12/lib/python3.12/site-packages/polars/lazyframe/frame.py", line 2043, in collect
    return wrap_df(ldf.collect(callback))
                   ^^^^^^^^^^^^^^^^^^^^^
polars.exceptions.ColumnNotFoundError: id

Resolved plan until failure:

	---> FAILED HERE RESOLVING 'select' <---
DF []; PROJECT */0 COLUMNS; SELECTION: None
2025-06-21 15:12:18 - INFO - main_update - main - Starting IMDB ratings update process
2025-06-21 15:12:18 - INFO - main_update - main - Step 1: Updating titles table
2025-06-21 15:12:18 - INFO - update_supabase - update_title_table - Starting title table update
2025-06-21 15:12:18 - INFO - movie_database - download_title_df - Starting IMDB data download and processing
2025-06-21 15:12:18 - INFO - movie_database - _download_basics_data - Fetching basic title data from https://datasets.imdbws.com/title.basics.tsv.gz
2025-06-21 15:12:53 - INFO - movie_database - _process_basics_data - Processing basic title data
2025-06-21 15:12:53 - INFO - movie_database - _download_ratings_data - Fetching ratings data from https://datasets.imdbws.com/title.ratings.tsv.gz
2025-06-21 15:12:55 - INFO - movie_database - _process_ratings_data - Processing ratings data (min votes: 15,000)
2025-06-21 15:12:55 - INFO - movie_database - _join_title_and_ratings - Joining title and ratings data
2025-06-21 15:12:55 - INFO - movie_database - download_title_df - Successfully processed 11,108 titles
2025-06-21 15:12:55 - INFO - update_supabase - download_titles_from_database - Downloading entire titles database from Supabase
2025-06-21 15:12:56 - ERROR - main_update - main - Update process failed: id

Resolved plan until failure:

	---> FAILED HERE RESOLVING 'select' <---
DF []; PROJECT */0 COLUMNS; SELECTION: None
Traceback (most recent call last):
  File "/Users/xingyuzhang/Desktop/imdb_ratings/imdb_ratings/updater/main_update.py", line 31, in main
    update_title_table()
  File "/Users/xingyuzhang/Desktop/imdb_ratings/imdb_ratings/updater/update_supabase.py", line 102, in update_title_table
    title_df_from_supabase.select(["id", "num_votes"]).rename({"num_votes": "num_votes_supabase"}),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xingyuzhang/Library/Caches/pypoetry/virtualenvs/imdb-ratings-1gaDbQ5W-py3.12/lib/python3.12/site-packages/polars/dataframe/frame.py", line 9322, in select
    return self.lazy().select(*exprs, **named_exprs).collect(_eager=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xingyuzhang/Library/Caches/pypoetry/virtualenvs/imdb-ratings-1gaDbQ5W-py3.12/lib/python3.12/site-packages/polars/lazyframe/frame.py", line 2043, in collect
    return wrap_df(ldf.collect(callback))
                   ^^^^^^^^^^^^^^^^^^^^^
polars.exceptions.ColumnNotFoundError: id

Resolved plan until failure:

	---> FAILED HERE RESOLVING 'select' <---
DF []; PROJECT */0 COLUMNS; SELECTION: None
2025-06-21 15:15:00 - INFO - main_update - main - Starting IMDB ratings update process
2025-06-21 15:15:00 - INFO - main_update - main - Step 1: Updating titles table
2025-06-21 15:15:00 - INFO - update_supabase - update_title_table - Starting title table update
2025-06-21 15:15:00 - INFO - movie_database - download_title_df - Starting IMDB data download and processing
2025-06-21 15:15:00 - INFO - movie_database - _download_basics_data - Fetching basic title data from https://datasets.imdbws.com/title.basics.tsv.gz
2025-06-21 15:16:58 - INFO - movie_database - _process_basics_data - Processing basic title data
2025-06-21 15:16:59 - INFO - movie_database - _download_ratings_data - Fetching ratings data from https://datasets.imdbws.com/title.ratings.tsv.gz
2025-06-21 15:17:04 - INFO - movie_database - _process_ratings_data - Processing ratings data (min votes: 15,000)
2025-06-21 15:17:04 - INFO - movie_database - _join_title_and_ratings - Joining title and ratings data
2025-06-21 15:17:04 - INFO - movie_database - download_title_df - Successfully processed 11,108 titles
2025-06-21 15:17:04 - INFO - update_supabase - download_titles_from_database - Downloading entire titles database from Supabase
2025-06-21 15:17:06 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 1/12
2025-06-21 15:17:08 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 2/12
2025-06-21 15:17:10 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 3/12
2025-06-21 15:17:12 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 4/12
2025-06-21 15:17:14 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 5/12
2025-06-21 15:17:15 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 6/12
2025-06-21 15:17:17 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 7/12
2025-06-21 15:17:19 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 8/12
2025-06-21 15:17:20 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 9/12
2025-06-21 15:17:22 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 10/12
2025-06-21 15:17:24 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 11/12
2025-06-21 15:17:25 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 12/12
2025-06-21 15:17:26 - INFO - update_supabase - update_title_table - Title table update completed successfully
2025-06-21 15:17:26 - INFO - main_update - main - Step 2: Skipping reviews update
2025-06-21 15:17:26 - INFO - main_update - main - Step 3: Skipping Excel export
2025-06-21 15:17:26 - INFO - main_update - main - Update process completed successfully
2025-06-21 15:20:31 - INFO - main_update - main - Starting IMDB ratings update process
2025-06-21 15:20:31 - INFO - main_update - main - Step 1: Skipping titles update
2025-06-21 15:20:31 - INFO - main_update - main - Step 2: Updating reviews table
2025-06-21 15:20:31 - INFO - update_supabase - update_reviews_table - Starting reviews table update
2025-06-21 15:20:31 - INFO - update_supabase - download_titles_from_database - Downloading entire titles database from Supabase
2025-06-21 15:20:35 - INFO - update_supabase - update_reviews_table - Found 11108 titles to process
2025-06-21 15:20:35 - INFO - update_supabase - update_reviews_table - Processing reviews for 1/11108 titles: tt0004972
2025-06-21 15:20:35 - DEBUG - scrape_reviews - get_reviews_from_title_code - Starting review extraction for tt0004972
2025-06-21 15:20:36 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 49 reviews so far for tt0004972
2025-06-21 15:20:39 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 98 reviews so far for tt0004972
2025-06-21 15:20:41 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 148 reviews so far for tt0004972
2025-06-21 15:20:43 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 195 reviews so far for tt0004972
2025-06-21 15:20:45 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 245 reviews so far for tt0004972
2025-06-21 15:20:47 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 295 reviews so far for tt0004972
2025-06-21 15:20:49 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 342 reviews so far for tt0004972
2025-06-21 15:20:50 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 380 reviews so far for tt0004972
2025-06-21 15:20:53 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 421 reviews so far for tt0004972
2025-06-21 15:20:54 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 424 reviews so far for tt0004972
2025-06-21 15:20:55 - DEBUG - scrape_reviews - get_reviews_from_title_code - Extracted 192/424 reviews for tt0004972 after filtering
2025-06-21 15:20:56 - INFO - update_supabase - upsert_rows_into_table - Successfully inserted batch 1/1
2025-06-21 15:20:57 - INFO - update_supabase - update_reviews_table - Inserted 192 reviews for tt0004972
2025-06-21 15:20:57 - INFO - update_supabase - update_reviews_table - Updated needsUpdate to False for title 4972
2025-06-21 15:20:57 - INFO - update_supabase - update_reviews_table - Processing reviews for 2/11108 titles: tt0006864
2025-06-21 15:20:57 - DEBUG - scrape_reviews - get_reviews_from_title_code - Starting review extraction for tt0006864
2025-06-21 15:20:58 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 50 reviews so far for tt0006864
2025-06-21 15:21:00 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 100 reviews so far for tt0006864
2025-06-21 15:21:02 - DEBUG - scrape_reviews - get_reviews_from_title_code - Fetched 142 reviews so far for tt0006864
